<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>SPL - Time Range e Transaction - Slide 11</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="nav-buttons">
        <div class="nav-btn" id="nav-menu"><svg viewBox="0 0 24 24"><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div>
        <div class="nav-btn" id="nav-prev"><svg viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"></polyline></svg></div>
        <div class="nav-btn" id="nav-next"><svg viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"></polyline></svg></div>
    </div>

    <div class="container">
        <h1 class="title">SPL: Time Range e Transaction</h1>
        <div class="subtitle">Gestione Temporale e Raggruppamento Eventi</div>

        <div class="grid-2-col">
            <div class="card border-blue">
                <div class="card-title">Time Range</div>
                <div class="card-text">
                    <p>Ogni evento in Splunk ha un timestamp. Usando il time picker o i comandi <code>earliest</code> e <code>latest</code>, puoi limitare le ricerche a periodi temporali specifici.</p>
                    <p style="margin-top: 15px;"><strong>Esempio:</strong></p>
                    <div class="code-box">index="main" earliest=-7d EventCode!=1</div>
                    <p style="margin-top: 15px;">Combinando la condizione <code>index="main"</code> con <code>earliest=-7d</code> e <code>EventCode!=1</code>, la query recupererà eventi dall'indice main che si sono verificati negli ultimi sette giorni e che non hanno un valore EventCode uguale a 1.</p>
                </div>
            </div>

            <div class="card border-green">
                <div class="card-title">transaction</div>
                <div class="card-text">
                    <p>Raggruppa eventi che condividono caratteristiche comuni in transazioni, spesso usato per tracciare sessioni o attività utente che si estendono su più eventi.</p>
                    <p style="margin-top: 15px;"><strong>Esempio:</strong></p>
                    <div class="code-box">index="main" sourcetype="WinEventLog:Sysmon" (EventCode=1 OR EventCode=3) | transaction Image startswith=eval(EventCode=1) endswith=eval(EventCode=3) maxspan=1m | table Image | dedup Image</div>
                </div>
            </div>
        </div>

        <div class="card border-purple" style="margin-top: 30px;">
            <div class="card-title">Spiegazione della Query transaction</div>
            <div class="card-text">
                <p><strong>1. Ricerca:</strong> Recupera eventi Sysmon con EventCode 1 (creazione processo) o 3 (connessione di rete).</p>
                <p><strong>2. transaction:</strong> Raggruppa eventi basandosi sul campo <code>Image</code> (eseguibile coinvolto). La transazione:</p>
                <ul style="margin-top: 10px; padding-left: 20px;">
                    <li>Inizia con un evento dove EventCode è 1</li>
                    <li>Finisce con un evento dove EventCode è 3</li>
                    <li>È limitata a eventi entro una finestra di 1 minuto (<code>maxspan=1m</code>)</li>
                </ul>
                <p style="margin-top: 15px;"><strong>Utilizzo:</strong> Questa query identifica sequenze di attività (creazione processo seguita da connessione di rete) associate allo stesso eseguibile entro 1 minuto. Utile per threat hunting, specialmente quando si cercano indicatori di compromissione come sequenze rapide di creazione processo e connessione di rete iniziate dallo stesso eseguibile.</p>
            </div>
        </div>
    </div>

    <script>const slideNumero = 11;</script>
    <script src="main.js"></script>
</body>
</html>

