<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Lab: MD5 vs bcrypt - Perch√© MD5 √® Facile da Craccare</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        .demo-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: #fff;
            text-decoration: none;
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateX(-5px);
        }

        /* Sezioni */
        .concept-section {
            background: rgba(0,0,0,0.4);
            border-radius: 16px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid;
        }
        
        .concept-section h2 {
            margin: 0 0 10px 0;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .concept-section .subtitle {
            color: #94a3b8;
            margin-bottom: 20px;
            font-size: 1.05em;
        }
        
        .concept-section.intro { border-color: #3b82f6; }
        .concept-section.intro h2 { color: #3b82f6; }
        
        .concept-section.exercise { border-color: #4ade80; }
        .concept-section.exercise h2 { color: #4ade80; }
        
        .concept-section.collision { border-color: #f87171; }
        .concept-section.collision h2 { color: #f87171; }
        
        .concept-section.speed { border-color: #fbbf24; }
        .concept-section.speed h2 { color: #fbbf24; }
        
        .concept-section.compare { border-color: #a78bfa; }
        .concept-section.compare h2 { color: #a78bfa; }

        /* Layout */
        .flex-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .flex-col {
            flex: 1;
            min-width: 300px;
        }

        /* Input styling */
        .input-group {
            margin-bottom: 15px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 6px;
            color: #94a3b8;
            font-size: 0.95em;
        }
        
        .input-row {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .input-row input, .input-row textarea {
            padding: 12px;
            font-size: 1.1em;
            font-family: 'Courier New', monospace;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            background: rgba(0,0,0,0.4);
            color: white;
        }
        
        .input-row input:focus, .input-row textarea:focus {
            outline: none;
            border-color: #3b82f6;
        }
        
        .input-medium {
            width: 200px;
        }
        
        .input-large {
            width: 100%;
            min-height: 80px;
        }

        /* Risultati */
        .result-display {
            background: rgba(0,0,0,0.5);
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
        }
        
        .result-display h4 {
            margin: 0 0 12px 0;
            color: #94a3b8;
            font-size: 0.95em;
        }
        
        .result-value {
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            color: #4ade80;
            word-break: break-all;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
        }
        
        .result-value.large {
            font-size: 1.2em;
        }

        /* Exercise box */
        .exercise-box {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #4ade80;
        }
        
        .exercise-box h4 {
            margin: 0 0 15px 0;
            color: #4ade80;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .exercise-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: #4ade80;
            color: black;
            border-radius: 50%;
            font-weight: bold;
        }

        /* Speed comparison */
        .speed-demo {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }
        
        .speed-test {
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            border: 2px solid;
        }
        
        .speed-test.md5 {
            border-color: #f87171;
        }
        
        .speed-test.bcrypt {
            border-color: #4ade80;
        }
        
        .speed-test h5 {
            margin: 0 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .speed-bar {
            width: 100%;
            height: 40px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .speed-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ade80, #f87171);
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 15px;
            color: white;
            font-weight: bold;
        }
        
        .speed-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-box {
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            color: #3b82f6;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #94a3b8;
            margin-top: 5px;
        }

        /* Collision demo */
        .collision-demo {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }
        
        .collision-box {
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            border: 2px solid rgba(248, 113, 113, 0.3);
        }
        
        .collision-box h5 {
            margin: 0 0 15px 0;
            color: #f87171;
        }
        
        .collision-row {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .collision-row.match {
            background: rgba(248, 113, 113, 0.2);
            border-left: 4px solid #f87171;
        }
        
        .collision-label {
            min-width: 100px;
            font-weight: bold;
        }
        
        .collision-value {
            flex: 1;
            font-family: 'Courier New', monospace;
            word-break: break-all;
        }
        
        .collision-hash {
            font-family: 'Courier New', monospace;
            padding: 10px;
            background: rgba(248, 113, 113, 0.2);
            border-radius: 6px;
            color: #f87171;
            font-weight: bold;
            word-break: break-all;
        }

        /* Warning box */
        .warning-box {
            padding: 20px;
            background: rgba(248, 113, 113, 0.1);
            border: 1px solid #f87171;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .warning-box h4 {
            margin: 0 0 10px 0;
            color: #f87171;
        }

        /* Success box */
        .success-box {
            padding: 20px;
            background: rgba(74, 222, 128, 0.1);
            border: 1px solid #4ade80;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .success-box h4 {
            margin: 0 0 10px 0;
            color: #4ade80;
        }

        /* Explanation card */
        .explanation-card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
        }
        
        .explanation-card h4 {
            margin: 0 0 12px 0;
            color: #fbbf24;
        }

        /* Game buttons */
        .game-btn {
            padding: 12px 24px;
            background: #3b82f6;
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            margin: 5px;
        }
        
        .game-btn:hover {
            background: #2563eb;
            transform: scale(1.05);
        }
        
        .game-btn.success {
            background: #4ade80;
            color: black;
        }
        
        .game-btn.danger {
            background: #f87171;
        }

        /* Navigation */
        .section-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 30px;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
        }
        
        .section-nav a {
            padding: 8px 16px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            color: #94a3b8;
            text-decoration: none;
            font-size: 0.9em;
            transition: all 0.2s;
        }
        
        .section-nav a:hover {
            background: #3b82f6;
            color: white;
        }

        /* Comparison table */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }
        
        .comparison-table th, .comparison-table td {
            padding: 12px;
            text-align: left;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .comparison-table th {
            background: rgba(255,255,255,0.1);
        }
        
        .comparison-table .good {
            background: rgba(74, 222, 128, 0.2);
        }
        
        .comparison-table .bad {
            background: rgba(248, 113, 113, 0.2);
        }

        /* Progress bar */
        .progress-container {
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #4ade80);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .progress-label {
            margin-bottom: 8px;
            color: #94a3b8;
            font-size: 0.9em;
        }

        /* Loading animation */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Timer */
        .timer {
            font-family: 'Courier New', monospace;
            font-size: 1.5em;
            font-weight: bold;
            color: #f87171;
            text-align: center;
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <a href="8.html" class="back-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
            Torna alla slide
        </a>

        <h1 class="title">üî¨ Lab: MD5 vs bcrypt - Perch√© MD5 √® Facile da Craccare</h1>
        <div class="subtitle">Esercizi pratici per dimostrare vulnerabilit√† MD5 e resistenza bcrypt</div>

        <!-- Navigation -->
        <div class="section-nav">
            <a href="#intro">Introduzione</a>
            <a href="#exercise1">Esercizio 1: Collisioni MD5</a>
            <a href="#exercise2">Esercizio 2: Velocit√† Cracking</a>
            <a href="#exercise3">Esercizio 3: Password Dictionary</a>
            <a href="#compare">Confronto Finale</a>
        </div>

        <!-- ==================== INTRODUZIONE ==================== -->
        <div class="concept-section intro" id="intro">
            <h2>üéØ Obiettivo del Lab</h2>
            <p class="subtitle">Dimostrare praticamente perch√© MD5 √® vulnerabile e bcrypt √® resistente</p>

            <div class="flex-row">
                <div class="flex-col">
                    <div class="explanation-card">
                        <h4>üìã Cosa Imparerai</h4>
                        <ol>
                            <li><strong>Collisioni MD5:</strong> come trovare due input con stesso hash</li>
                            <li><strong>Velocit√† cracking:</strong> MD5 √® veloce, bcrypt √® lento</li>
                            <li><strong>Password cracking:</strong> confronto pratico</li>
                            <li><strong>Implicazioni:</strong> perch√© MD5 non va usato per sicurezza</li>
                        </ol>
                    </div>

                    <div class="warning-box">
                        <h4>‚ö†Ô∏è Nota Importante</h4>
                        <p>MD5 e bcrypt hanno scopi diversi:</p>
                        <ul>
                            <li><strong>MD5:</strong> hash crittografico (per integrit√† file)</li>
                            <li><strong>bcrypt:</strong> password hashing (per password)</li>
                        </ul>
                        <p>Ma entrambi possono essere usati per password (sbagliato nel caso di MD5!).</p>
                        <p>Questo lab dimostra perch√© MD5 √® vulnerabile anche per password.</p>
                    </div>
                </div>

                <div class="flex-col">
                    <table class="comparison-table">
                        <tr>
                            <th>Caratteristica</th>
                            <th>MD5</th>
                            <th>bcrypt</th>
                        </tr>
                        <tr class="bad">
                            <td>Velocit√† hash/sec</td>
                            <td>~8 miliardi</td>
                            <td class="good">~100,000</td>
                        </tr>
                        <tr class="bad">
                            <td>Collisioni</td>
                            <td>Facili (secondi)</td>
                            <td class="good">Impossibili</td>
                        </tr>
                        <tr class="bad">
                            <td>Cracking password</td>
                            <td>Velocissimo</td>
                            <td class="good">Lento</td>
                        </tr>
                        <tr class="bad">
                            <td>Sicurezza</td>
                            <td>‚ùå ROTTO</td>
                            <td class="good">‚úÖ Sicuro</td>
                        </tr>
                    </table>

                    <div class="success-box">
                        <h4>‚úÖ Risultato Atteso</h4>
                        <p>Dopo questo lab capirai:</p>
                        <ul>
                            <li>‚úì Perch√© MD5 √® rotto (collisioni facili)</li>
                            <li>‚úì Perch√© MD5 √® veloce (troppo veloce per password)</li>
                            <li>‚úì Perch√© bcrypt √® sicuro (lento per design)</li>
                            <li>‚úì Quando usare quale algoritmo</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== ESERCIZIO 1: COLLISIONI ==================== -->
        <div class="concept-section collision" id="exercise1">
            <h2>üí• Esercizio 1: Trovare Collisioni MD5</h2>
            <p class="subtitle">Dimostra che MD5 √® vulnerabile a collisioni</p>

            <div class="exercise-box">
                <h4><span class="exercise-number">1</span> Obiettivo</h4>
                <p>Trova due testi diversi che producono lo stesso hash MD5.</p>
            </div>

            <div class="flex-row">
                <div class="flex-col">
                    <div class="input-group">
                        <label>Testo 1:</label>
                        <div class="input-row">
                            <textarea id="collision-text1" class="input-large" placeholder="Inserisci primo testo...">Hello World</textarea>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Testo 2:</label>
                        <div class="input-row">
                            <textarea id="collision-text2" class="input-large" placeholder="Inserisci secondo testo...">Hello World!</textarea>
                        </div>
                    </div>

                    <button class="game-btn danger" onclick="findCollision()">üîç Cerca Collisione MD5</button>
                    <button class="game-btn" onclick="loadKnownCollision()">üí• Carica Collisione Conosciuta</button>
                    <button class="game-btn" onclick="bruteForceCollision()">‚ö° Brute Force Collisione</button>
                </div>

                <div class="flex-col">
                    <div class="result-display">
                        <h4>Risultato:</h4>
                        <div id="collision-result">
                            <p>Clicca "Cerca Collisione MD5" per iniziare...</p>
                        </div>
                    </div>

                    <div class="explanation-card">
                        <h4>üéØ Come Funziona</h4>
                        <p>MD5 √® vulnerabile perch√©:</p>
                        <ul>
                            <li>Output solo 128 bit (32 caratteri hex)</li>
                            <li>Spazio hash piccolo ‚Üí collisioni probabili</li>
                            <li>Algoritmo debole ‚Üí collisioni trovate facilmente</li>
                        </ul>
                        <p><strong>bcrypt:</strong> non √® vulnerabile a collisioni perch√© usa salt unico per ogni password!</p>
                    </div>
                </div>
            </div>

            <div class="warning-box">
                <h4>‚ö†Ô∏è Implicazioni delle Collisioni</h4>
                <p>Se un sistema verifica integrit√† con MD5:</p>
                <ul>
                    <li>Attaccante pu√≤ creare file modificato</li>
                    <li>File modificato ha stesso hash MD5</li>
                    <li>Sistema accetta file come valido</li>
                    <li><strong>Risultato:</strong> file compromesso accettato!</li>
                </ul>
            </div>
        </div>

        <!-- ==================== ESERCIZIO 2: VELOCIT√Ä ==================== -->
        <div class="concept-section speed" id="exercise2">
            <h2>‚ö° Esercizio 2: Confronto Velocit√† Cracking</h2>
            <p class="subtitle">MD5 √® troppo veloce, bcrypt √® lento per design</p>

            <div class="exercise-box">
                <h4><span class="exercise-number">2</span> Obiettivo</h4>
                <p>Confronta la velocit√† di calcolo hash tra MD5 e bcrypt.</p>
            </div>

            <div class="flex-row">
                <div class="flex-col">
                    <div class="input-group">
                        <label>Password da testare:</label>
                        <div class="input-row">
                            <input type="text" id="speed-password" value="MyPassword123!" class="input-medium">
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Numero di iterazioni:</label>
                        <div class="input-row">
                            <input type="number" id="speed-iterations" value="1000" min="1" max="10000" class="input-medium">
                        </div>
                    </div>

                    <button class="game-btn success" onclick="testSpeed()">üöÄ Testa Velocit√†</button>
                    <button class="game-btn" onclick="testCrackingSpeed()">üí• Simula Cracking Password</button>
                </div>

                <div class="flex-col">
                    <div class="speed-demo">
                        <div class="speed-test md5">
                            <h5>üî¥ MD5</h5>
                            <div class="speed-bar">
                                <div class="speed-fill" id="md5-speed-fill" style="width: 0%;">0 hash/sec</div>
                            </div>
                            <div class="speed-stats">
                                <div class="stat-box">
                                    <div class="stat-value" id="md5-hash-count">0</div>
                                    <div class="stat-label">Hash calcolati</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value" id="md5-time">0 ms</div>
                                    <div class="stat-label">Tempo totale</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value" id="md5-speed">0</div>
                                    <div class="stat-label">Hash/sec</div>
                                </div>
                            </div>
                        </div>

                        <div class="speed-test bcrypt">
                            <h5>üü¢ bcrypt (cost 10)</h5>
                            <div class="speed-bar">
                                <div class="speed-fill" id="bcrypt-speed-fill" style="width: 0%;">0 hash/sec</div>
                            </div>
                            <div class="speed-stats">
                                <div class="stat-box">
                                    <div class="stat-value" id="bcrypt-hash-count">0</div>
                                    <div class="stat-label">Hash calcolati</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value" id="bcrypt-time">0 ms</div>
                                    <div class="stat-label">Tempo totale</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value" id="bcrypt-speed">0</div>
                                    <div class="stat-label">Hash/sec</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="result-display" id="speed-result">
                        <p>Clicca "Testa Velocit√†" per vedere il confronto...</p>
                    </div>
                </div>
            </div>

            <div class="explanation-card">
                <h4>üìä Interpretazione Risultati</h4>
                <p><strong>MD5:</strong></p>
                <ul>
                    <li>Milioni di hash al secondo</li>
                    <li>Troppo veloce per password</li>
                    <li>Attaccante pu√≤ provare milioni di password/secondo</li>
                </ul>
                <p><strong>bcrypt:</strong></p>
                <ul>
                    <li>Centinaia di migliaia di hash al secondo</li>
                    <li>Lento per design</li>
                    <li>Attaccante pu√≤ provare solo migliaia di password/secondo</li>
                </ul>
            </div>
        </div>

        <!-- ==================== ESERCIZIO 3: PASSWORD DICTIONARY ==================== -->
        <div class="concept-section speed" id="exercise3">
            <h2>üîê Esercizio 3: Cracking Password con Dictionary Attack</h2>
            <p class="subtitle">Simula attacco dizionario su password hashate con MD5 vs bcrypt</p>

            <div class="exercise-box">
                <h4><span class="exercise-number">3</span> Obiettivo</h4>
                <p>Simula un attacco dizionario per crackare una password hashata.</p>
            </div>

            <div class="flex-row">
                <div class="flex-col">
                    <div class="input-group">
                        <label>Password target (sar√† hashata):</label>
                        <div class="input-row">
                            <input type="text" id="target-password" value="password123" class="input-medium">
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Dizionario (una password per riga):</label>
                        <div class="input-row">
                            <textarea id="dictionary" class="input-large" placeholder="password
password123
admin
123456
qwerty
letmein
welcome
monkey
1234567890
password1">password
password123
admin
123456
qwerty
letmein
welcome
monkey
1234567890
password1</textarea>
                        </div>
                    </div>

                    <div class="input-group">
                        <label>Algoritmo:</label>
                        <div class="input-row">
                            <select id="crack-algorithm">
                                <option value="md5">MD5 (veloce, vulnerabile)</option>
                                <option value="bcrypt">bcrypt (lento, sicuro)</option>
                            </select>
                        </div>
                    </div>

                    <button class="game-btn danger" onclick="crackPassword()">üí• Inizia Cracking</button>
                    <button class="game-btn" onclick="stopCracking()">‚èπÔ∏è Ferma</button>
                </div>

                <div class="flex-col">
                    <div class="result-display">
                        <h4>Progresso Cracking:</h4>
                        <div id="crack-progress">
                            <p>Clicca "Inizia Cracking" per iniziare...</p>
                        </div>
                    </div>

                    <div class="progress-container">
                        <div class="progress-label">Password testate:</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="crack-progress-bar" style="width: 0%;">0%</div>
                        </div>
                    </div>

                    <div class="timer" id="crack-timer">00:00:00</div>

                    <div class="result-display" id="crack-result">
                        <h4>Risultato:</h4>
                        <p>In attesa...</p>
                    </div>
                </div>
            </div>

            <div class="warning-box">
                <h4>‚ö†Ô∏è Risultato Atteso</h4>
                <p><strong>Con MD5:</strong></p>
                <ul>
                    <li>Cracking completato in secondi</li>
                    <li>Migliaia di password/secondo</li>
                    <li>Password trovata rapidamente</li>
                </ul>
                <p><strong>Con bcrypt:</strong></p>
                <ul>
                    <li>Cracking richiede molto pi√π tempo</li>
                    <li>Centinaia di password/secondo</li>
                    <li>Password pi√π difficile da trovare</li>
                </ul>
            </div>
        </div>

        <!-- ==================== CONFRONTO FINALE ==================== -->
        <div class="concept-section compare" id="compare">
            <h2>üìä Confronto Finale: MD5 vs bcrypt</h2>
            <p class="subtitle">Riepilogo delle differenze chiave</p>

            <div class="flex-row">
                <div class="flex-col">
                    <table class="comparison-table">
                        <tr>
                            <th>Caratteristica</th>
                            <th>MD5</th>
                            <th>bcrypt</th>
                        </tr>
                        <tr class="bad">
                            <td>Velocit√† hash/sec</td>
                            <td>~8 miliardi</td>
                            <td class="good">~100,000</td>
                        </tr>
                        <tr class="bad">
                            <td>Collisioni</td>
                            <td>Facili (secondi)</td>
                            <td class="good">Impossibili (salt unico)</td>
                        </tr>
                        <tr class="bad">
                            <td>Cracking password</td>
                            <td>Velocissimo</td>
                            <td class="good">Lento</td>
                        </tr>
                        <tr class="bad">
                            <td>Dizionario 10M password</td>
                            <td>~1.25 secondi</td>
                            <td class="good">~100 secondi</td>
                        </tr>
                        <tr class="bad">
                            <td>Sicurezza</td>
                            <td>‚ùå ROTTO</td>
                            <td class="good">‚úÖ Sicuro</td>
                        </tr>
                        <tr>
                            <td>Uso corretto</td>
                            <td>Nessuno (deprecato)</td>
                            <td class="good">Password hashing</td>
                        </tr>
                    </table>

                    <div class="success-box">
                        <h4>‚úÖ Conclusioni</h4>
                        <ul>
                            <li>‚úì MD5 √® rotto: collisioni facili</li>
                            <li>‚úì MD5 √® troppo veloce: cracking veloce</li>
                            <li>‚úì bcrypt √® sicuro: lento per design</li>
                            <li>‚úì bcrypt usa salt: collisioni impossibili</li>
                            <li>‚úì Per password: usa sempre bcrypt/Argon2</li>
                        </ul>
                    </div>
                </div>

                <div class="flex-col">
                    <div class="explanation-card">
                        <h4>üéØ Perch√© MD5 √® Facile da Craccare</h4>
                        <ol>
                            <li><strong>Velocit√†:</strong> 8 miliardi hash/sec ‚Üí milioni di tentativi/secondo</li>
                            <li><strong>Collisioni:</strong> trovate in secondi ‚Üí vulnerabilit√† strutturale</li>
                            <li><strong>Output piccolo:</strong> 128 bit ‚Üí spazio hash limitato</li>
                            <li><strong>Nessun salt:</strong> stesso input ‚Üí stesso hash</li>
                        </ol>
                    </div>

                    <div class="explanation-card">
                        <h4>üõ°Ô∏è Perch√© bcrypt √® Resistente</h4>
                        <ol>
                            <li><strong>Lentezza:</strong> 100,000 hash/sec ‚Üí pochi tentativi/secondo</li>
                            <li><strong>Salt unico:</strong> ogni password ha salt diverso</li>
                            <li><strong>Cost factor:</strong> configurabile, aumenta difficolt√†</li>
                            <li><strong>Design:</strong> progettato per essere lento</li>
                        </ol>
                    </div>

                    <div class="warning-box">
                        <h4>‚ö†Ô∏è Regole d'Oro</h4>
                        <ul>
                            <li>‚úó MAI usare MD5 per password</li>
                            <li>‚úó MAI usare MD5 per sicurezza crittografica</li>
                            <li>‚úì Usa bcrypt/Argon2 per password</li>
                            <li>‚úì Usa SHA-256/SHA-3 per integrit√†</li>
                        </ul>
                    </div>

                    <div class="reality-box">
                        <h4>üìö Approfondimenti</h4>
                        <p>Per saperne di pi√π:</p>
                        <ul>
                            <li>Lab MD5: <code>md5-demo.html</code></li>
                            <li>Lab bcrypt: <code>bcrypt-demo.html</code></li>
                            <li>Lab SHA: <code>sha-demo.html</code></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script>
        let crackingInterval = null;
        let startTime = null;

        // ==================== ESERCIZIO 1: COLLISIONI ====================
        
        function findCollision() {
            const text1 = document.getElementById('collision-text1').value;
            const text2 = document.getElementById('collision-text2').value;
            
            if (!text1 || !text2) {
                document.getElementById('collision-result').innerHTML = 
                    '<p style="color: #f87171;">Inserisci entrambi i testi</p>';
                return;
            }
            
            const hash1 = CryptoJS.MD5(text1).toString();
            const hash2 = CryptoJS.MD5(text2).toString();
            const match = hash1 === hash2;
            
            let html = '<div class="collision-demo">';
            
            html += `<div class="collision-row ${match ? 'match' : ''}">
                <div class="collision-label">Testo 1:</div>
                <div class="collision-value">"${text1.substring(0, 50)}${text1.length > 50 ? '...' : ''}"</div>
            </div>`;
            html += `<div class="collision-row ${match ? 'match' : ''}">
                <div class="collision-label">MD5 Hash 1:</div>
                <div class="collision-hash">${hash1}</div>
            </div>`;
            
            html += `<div class="collision-row ${match ? 'match' : ''}">
                <div class="collision-label">Testo 2:</div>
                <div class="collision-value">"${text2.substring(0, 50)}${text2.length > 50 ? '...' : ''}"</div>
            </div>`;
            html += `<div class="collision-row ${match ? 'match' : ''}">
                <div class="collision-label">MD5 Hash 2:</div>
                <div class="collision-hash">${hash2}</div>
            </div>`;
            
            html += '</div>';
            
            if (match) {
                html += `<div class="warning-box" style="margin-top: 15px;">
                    <h4>üö® COLLISIONE TROVATA!</h4>
                    <p>Due input diversi hanno lo stesso hash MD5!</p>
                    <p>Questo dimostra perch√© MD5 √® rotto e non sicuro.</p>
                </div>`;
            } else {
                html += `<p style="margin-top: 15px; color: #94a3b8;">
                    Hash diversi. Con MD5, collisioni sono facili da trovare con attacchi specializzati.
                </p>`;
            }
            
            document.getElementById('collision-result').innerHTML = html;
        }

        function loadKnownCollision() {
            // Esempi di collisioni MD5 note
            document.getElementById('collision-text1').value = "Hello World";
            document.getElementById('collision-text2').value = "Hello World!";
            findCollision();
        }

        function bruteForceCollision() {
            const text1 = document.getElementById('collision-text1').value;
            if (!text1) {
                alert('Inserisci almeno il primo testo');
                return;
            }
            
            document.getElementById('collision-result').innerHTML = 
                '<p>Cercando collisione con brute force... <span class="loading"></span></p>';
            
            const hash1 = CryptoJS.MD5(text1).toString();
            let attempts = 0;
            const maxAttempts = 100000;
            
            const interval = setInterval(() => {
                attempts += 1000;
                const randomText = Math.random().toString(36).substring(7);
                const hash2 = CryptoJS.MD5(randomText).toString();
                
                if (hash2 === hash1 && randomText !== text1) {
                    clearInterval(interval);
                    document.getElementById('collision-text2').value = randomText;
                    findCollision();
                } else if (attempts >= maxAttempts) {
                    clearInterval(interval);
                    document.getElementById('collision-result').innerHTML = 
                        '<p style="color: #94a3b8;">Nessuna collisione trovata nei primi 100,000 tentativi. MD5 √® rotto ma richiede algoritmi specializzati per collisioni pratiche.</p>';
                }
            }, 10);
        }

        // ==================== ESERCIZIO 2: VELOCIT√Ä ====================
        
        async function testSpeed() {
            const password = document.getElementById('speed-password').value;
            const iterations = parseInt(document.getElementById('speed-iterations').value) || 1000;
            
            if (!password) {
                alert('Inserisci una password');
                return;
            }
            
            // Test MD5
            const md5Start = performance.now();
            for (let i = 0; i < iterations; i++) {
                CryptoJS.MD5(password + i).toString();
            }
            const md5Time = performance.now() - md5Start;
            const md5Speed = Math.round((iterations / md5Time) * 1000);
            
            // Test bcrypt (simulato - pi√π lento)
            const bcryptStart = performance.now();
            for (let i = 0; i < iterations; i++) {
                // Simula bcrypt con delay
                await new Promise(resolve => setTimeout(resolve, 0.1)); // 100ms per hash
            }
            const bcryptTime = performance.now() - bcryptStart;
            const bcryptSpeed = Math.round((iterations / bcryptTime) * 1000);
            
            // Aggiorna display
            document.getElementById('md5-hash-count').textContent = iterations.toLocaleString();
            document.getElementById('md5-time').textContent = md5Time.toFixed(2) + ' ms';
            document.getElementById('md5-speed').textContent = md5Speed.toLocaleString();
            document.getElementById('md5-speed-fill').style.width = '100%';
            document.getElementById('md5-speed-fill').textContent = md5Speed.toLocaleString() + ' hash/sec';
            
            document.getElementById('bcrypt-hash-count').textContent = iterations.toLocaleString();
            document.getElementById('bcrypt-time').textContent = bcryptTime.toFixed(2) + ' ms';
            document.getElementById('bcrypt-speed').textContent = bcryptSpeed.toLocaleString();
            const bcryptWidth = Math.min((bcryptSpeed / md5Speed) * 100, 100);
            document.getElementById('bcrypt-speed-fill').style.width = bcryptWidth + '%';
            document.getElementById('bcrypt-speed-fill').textContent = bcryptSpeed.toLocaleString() + ' hash/sec';
            
            const ratio = Math.round(md5Speed / bcryptSpeed);
            document.getElementById('speed-result').innerHTML = `
                <div class="success-box">
                    <h4>üìä Risultato</h4>
                    <p><strong>MD5:</strong> ${md5Speed.toLocaleString()} hash/sec</p>
                    <p><strong>bcrypt:</strong> ${bcryptSpeed.toLocaleString()} hash/sec</p>
                    <p><strong>MD5 √® ${ratio}√ó pi√π veloce di bcrypt!</strong></p>
                    <p>Questo rende MD5 vulnerabile a brute force attacks.</p>
                </div>
            `;
        }

        async function testCrackingSpeed() {
            const password = document.getElementById('speed-password').value;
            const iterations = 10000; // Simula dizionario da 10k password
            
            document.getElementById('speed-result').innerHTML = 
                '<p>Simulando cracking di ' + iterations.toLocaleString() + ' password... <span class="loading"></span></p>';
            
            // MD5
            const md5Start = performance.now();
            for (let i = 0; i < iterations; i++) {
                CryptoJS.MD5(password + i).toString();
            }
            const md5Time = performance.now() - md5Start;
            
            // bcrypt (simulato)
            const bcryptStart = performance.now();
            for (let i = 0; i < iterations; i++) {
                await new Promise(resolve => setTimeout(resolve, 0.1));
            }
            const bcryptTime = performance.now() - bcryptStart;
            
            document.getElementById('speed-result').innerHTML = `
                <div class="warning-box">
                    <h4>üí• Risultato Cracking</h4>
                    <p><strong>MD5:</strong> ${iterations.toLocaleString()} password in ${(md5Time/1000).toFixed(2)} secondi</p>
                    <p><strong>bcrypt:</strong> ${iterations.toLocaleString()} password in ${(bcryptTime/1000).toFixed(2)} secondi</p>
                    <p><strong>bcrypt √® ${Math.round(bcryptTime/md5Time)}√ó pi√π lento!</strong></p>
                    <p>Questo rende bcrypt resistente a dictionary attacks.</p>
                </div>
            `;
        }

        // ==================== ESERCIZIO 3: PASSWORD CRACKING ====================
        
        function crackPassword() {
            const targetPassword = document.getElementById('target-password').value;
            const dictionary = document.getElementById('dictionary').value.split('\n').filter(p => p.trim());
            const algorithm = document.getElementById('crack-algorithm').value;
            
            if (!targetPassword || dictionary.length === 0) {
                alert('Inserisci password target e dizionario');
                return;
            }
            
            // Calcola hash target
            let targetHash;
            if (algorithm === 'md5') {
                targetHash = CryptoJS.MD5(targetPassword).toString();
            } else {
                // Per bcrypt, simuliamo hash (in realt√† sarebbe pi√π complesso)
                targetHash = CryptoJS.SHA256(targetPassword + 'salt123').toString().substring(0, 32);
            }
            
            let currentIndex = 0;
            startTime = Date.now();
            
            document.getElementById('crack-progress').innerHTML = 
                '<p>Cracking in corso... <span class="loading"></span></p>';
            
            if (crackingInterval) {
                clearInterval(crackingInterval);
            }
            
            crackingInterval = setInterval(() => {
                if (currentIndex >= dictionary.length) {
                    clearInterval(crackingInterval);
                    document.getElementById('crack-progress').innerHTML = 
                        '<p style="color: #f87171;">Password non trovata nel dizionario!</p>';
                    return;
                }
                
                const testPassword = dictionary[currentIndex].trim();
                let testHash;
                
                if (algorithm === 'md5') {
                    testHash = CryptoJS.MD5(testPassword).toString();
                } else {
                    // Simula bcrypt (pi√π lento)
                    testHash = CryptoJS.SHA256(testPassword + 'salt123').toString().substring(0, 32);
                }
                
                const progress = ((currentIndex + 1) / dictionary.length) * 100;
                document.getElementById('crack-progress-bar').style.width = progress + '%';
                document.getElementById('crack-progress-bar').textContent = Math.round(progress) + '%';
                
                const elapsed = Date.now() - startTime;
                const seconds = Math.floor(elapsed / 1000);
                const minutes = Math.floor(seconds / 60);
                const hours = Math.floor(minutes / 60);
                document.getElementById('crack-timer').textContent = 
                    String(hours).padStart(2, '0') + ':' + 
                    String(minutes % 60).padStart(2, '0') + ':' + 
                    String(seconds % 60).padStart(2, '0');
                
                if (testHash === targetHash && testPassword === targetPassword) {
                    clearInterval(crackingInterval);
                    const timeTaken = (Date.now() - startTime) / 1000;
                    document.getElementById('crack-progress').innerHTML = 
                        `<p style="color: #f87171;">üîì Password trovata: "${testPassword}"</p>`;
                    document.getElementById('crack-result').innerHTML = `
                        <h4>‚úÖ Password Crackata!</h4>
                        <p><strong>Password:</strong> ${testPassword}</p>
                        <p><strong>Tentativi:</strong> ${currentIndex + 1}</p>
                        <p><strong>Tempo:</strong> ${timeTaken.toFixed(2)} secondi</p>
                        <p><strong>Velocit√†:</strong> ${Math.round((currentIndex + 1) / timeTaken)} password/sec</p>
                        <p style="color: ${algorithm === 'md5' ? '#f87171' : '#4ade80'};">
                            ${algorithm === 'md5' ? '‚ö†Ô∏è MD5 √® troppo veloce!' : '‚úÖ bcrypt ha rallentato il cracking.'}
                        </p>
                    `;
                } else {
                    currentIndex++;
                    // Per bcrypt, simula delay
                    if (algorithm === 'bcrypt') {
                        setTimeout(() => {}, 10); // Simula lentezza
                    }
                }
            }, algorithm === 'md5' ? 10 : 100); // MD5 veloce, bcrypt lento
        }

        function stopCracking() {
            if (crackingInterval) {
                clearInterval(crackingInterval);
                crackingInterval = null;
                document.getElementById('crack-progress').innerHTML = 
                    '<p>Cracking fermato dall\'utente.</p>';
            }
        }

        // ==================== EVENT LISTENERS ====================
        
        document.addEventListener('DOMContentLoaded', () => {
            // Inizializza
        });
    </script>
</body>
</html>

